<%= form_for(@off_hire_report, :html => {:class => "form-horizontal form-validate", :id => "off-hire-report-form"}) do |f| %>
  <% if @off_hire_report.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@off_hire_report.errors.count, "error") %> prohibited this page from being saved:</h2>

      <ul>
      <% @off_hire_report.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <%= f.hidden_field :hire_agreement_id %>
  <%= f.hidden_field :user_id %>

  <div class="row-fluid">
    <div class="span6">
      <div class="box-title">
        <h3><i class="icon-user"></i>Dropoff Driver</h3>
      </div>
      <div class="box-content">
        <div class="control-group">
          <%= f.label :dropoff_person_first_name, "First Name", :class => "control-label" %>
          <div class="controls">
            <%= f.text_field :dropoff_person_first_name, :class => "input-large" %>
          </div>
        </div>

        <div class="control-group">
          <%= f.label :dropoff_person_last_name, "Last Name", :class => "control-label" %>
          <div class="controls">
            <%= f.text_field :dropoff_person_last_name, :class => "input-large" %>
          </div>
        </div>

        <div class="control-group">
          <%= f.label :dropoff_person_phone, "Phone", :class => "control-label" %>
          <div class="controls">
            <%= f.text_field :dropoff_person_phone, :class => "input-large" %>
          </div>
        </div>

        <div class="control-group">
          <%= f.label :dropoff_person_licence_number, "Licence No", :class => "control-label" %>
          <div class="controls">
            <%= f.text_field :dropoff_person_licence_number, :class => "input-large" %>
          </div>
        </div>

        <hr>

        <div class="control-group">
          <%= f.label :report_date_field, "Date", :class => "control-label" %>
          <div class="controls">
            <div class="input-append">
              <%= f.text_field :report_date_field, {:class => "input-small datepick mask_date", 'data-rule-required' => true} %>
              <span class='add-on'><i class='icon-calendar'></i></span>
            </div>
          </div>
        </div>

        <div class="control-group">
          <%= f.label :report_time_field, "Time", :class => "control-label" %>
          <div class="controls">
            <div class="input-append">
              <%= f.text_field :report_time_field, {:class => "input-small timepick", 'data-rule-required' => true} %>
              <span class='add-on'><i class='icon-time'></i></span>
            </div>
          </div>
        </div>
      </div>     
    </div>

    <div class="span6">
      <div class="box-title">
        <h3><i class="glyphicon-car"></i>Vehicle Details</h3>
      </div>
      <div class="box-content nopadding">
        <table id="vehicle" class="table table-bordered table-force-topborder" style="clear: both">
          <tbody>
            <tr>         
              <td>Year, Make &amp; Model</td>
              <td width="65%"><%= @hire_agreement.vehicle.name %></td>
            </tr>
            <tr>         
              <td>Vehicle Number</td>
              <td width="65%"><%= @hire_agreement.vehicle.number %></td>
            </tr>
            <tr>         
              <td>VIN Number</td>
              <td width="65%"><%= @hire_agreement.vehicle.vin_number %></td>
            </tr>
            <tr>         
              <td>Engine Number</td>
              <td width="65%"><%= @hire_agreement.vehicle.engine_number %></td>
            </tr>
            <tr>         
              <td>Transmission</td>
              <td width="65%"><%= @hire_agreement.vehicle.transmission %></td>
            </tr>
            <tr>         
              <td>Rego Number</td>
              <td width="65%"><%= @hire_agreement.vehicle.rego_number %></td>
            </tr>
            <tr>         
              <td>Seating Capacity</td>
              <td width="65%"><%= @hire_agreement.vehicle.seating_capacity %></td>
            </tr>
          </tbody>
        </table>
      </div>    
    </div>
  </div>

  <div class="box-title">
    <h3><i class="icon-dashboard"></i>Odometer Reading</h3>
  </div>
  <div class="box-content">
    <div class="control-group">
      <%= f.label :odometer_reading, "Odometer", :class => "control-label" %>
      <div class="controls">
        <div class="input-append">
          <%= f.text_field :odometer_reading, {:class => "input-medium", 'data-rule-required' => true} %>
          <span class='add-on'>KM</span>
        </div>
      </div>
    </div>
  </div>

  <div class="box-title">
    <h3><i class="icon-edit"></i>Inspection Notes</h3>
  </div>
  <div class="box-content">
    <div class="control-group">
      <%= f.label :notes_exterior, "Exterior Details", :class => "control-label" %>
      <div class="controls">
        <%= f.text_area :notes_exterior, {:id => 'notes_exterior_editor', :class => "span12", 'rows' => 5} %>
      </div>
    </div>

    <hr>

    <div class="control-group">
      <%= f.label :notes_interior, "Interior Details", :class => "control-label" %>
      <div class="controls">
        <%= f.text_area :notes_interior, {:id => 'notes_interior_editor', :class => "span12", 'rows' => 5} %>
      </div>
    </div>

    <hr>

    <div class="control-group">
      <%= f.label :notes_other, "Other Details", :class => "control-label" %>
      <div class="controls">
        <%= f.text_area :notes_other, {:id => 'notes_other_editor', :class => "span12", 'rows' => 5} %>
      </div>
    </div>
  </div>

  <div class="box-title">
    <h3><i class="icon-ok-sign"></i>Mine Spec &amp; Gear Checklist</h3>
  </div>
  <div class="box-content checklist">
    <div class="alert alert-warning">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
      <i class="icon-info-sign"></i> Check each item below. Make notes of any missing items or items that are not required for hire in details section above.
    </div>

    <div class="row-fluid">
      <div class="span4">
        <div class="check-line">
          <%= f.check_box :spare_tyre_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :spare_tyre_check, "Spare Tyre", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :tool_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :tool_check, "Wheel Jack and Tools", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :wheel_nut_indicator_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :wheel_nut_indicator_check, "Wheel Nut Indicators", :class => "inline" %>
        </div>
      </div>

      <div class="span4">
        <div class="check-line">
          <%= f.check_box :triangle_stand_reflector_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :triangle_stand_reflector_check, "Triangle Stand Reflectors", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :first_aid_kit_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :first_aid_kit_check, "First Aid Kit", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :wheel_chock_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :wheel_chock_check, "Wheel Chocks", :class => "inline" %>
        </div>
      </div>

      <div class="span4">
        <div class="check-line">
          <%= f.check_box :jump_start_lead_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :jump_start_lead_check, "Jump Start Leads", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :fire_extinguisher_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :fire_extinguisher_check, "Fire Extinguisher", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :mine_flag_check, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :mine_flag_check, "Mine Flag", :class => "inline" %>
        </div>
      </div>
    </div>
  </div>

  <div class="box-title">
    <h3><i class="glyphicon-tint"></i>Vehicle Check</h3>
  </div>
  <div class="box-content checklist">
    <div class="alert alert-warning">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
      <i class="icon-info-sign"></i> Check that the fuel tank is full. How many litres were required to top up the fuel tank?
    </div>
    <div class="control-group">
      <%= f.label :fuel_litres, "Fuel required", :class => "control-label" %>
      <div class="controls">
        <div class="input-append">
          <%= f.text_field :fuel_litres, {:class => "input-small", 'data-rule-positiveNumber' => true} %>
          <span class='add-on'>Litres</span>
        </div>
      </div>
    </div>

    <div class="alert alert-warning">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
      <i class="icon-info-sign"></i> Check the vehicle for the other items. Make notes where needed. 
    </div>
    <div class="row-fluid">

      <div class="span4">
        <div class="check-line">
          <%= f.check_box :check_lights, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :check_lights, "All Lights Are Working?", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :check_horn, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :check_horn, "Horn Sounds Clearly?", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.label :check_windscreen_washer_bottle, "Windscreen Washer Bottle is Full?", :class => "inline" %>
          <%= f.check_box :check_windscreen_washer_bottle, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
        </div>
      </div>

      <div class="span4">
        <div class="check-line">
          <%= f.check_box :check_wiper_blades, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :check_wiper_blades, "Wiper Blades are Working?", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :check_service_sticker, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :check_service_sticker, "Service Sticker on Windscreen?", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.label :check_windscreen_chips, "Does Windscreen have Stone Chips?", :class => "inline" %>
          <%= f.check_box :check_windscreen_chips, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
        </div>
      </div>

      <div class="span4">
        <div class="check-line">
          <%= f.check_box :check_vehicle_clean, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :check_vehicle_clean, "Is Vehicle Clean?", :class => "inline" %>
        </div>
      </div>  
    </div>   
  </div>

  <div class="box-title">
    <h3><i class="icon-ok-sign"></i>Photo Checklist</h3>
  </div>
  <div class="box-content checklist">

    <div class="alert alert-warning">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
      <i class="icon-info-sign"></i> Mark off photos that have been uploaded in the upload photos section below.
    </div>

    <div class="row-fluid">
      <div class="span4">
        <div class="check-line">
          <%= f.check_box :photo_check_front, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :photo_check_front, "Front", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :photo_check_passenger_side, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :photo_check_passenger_side, "Passenger Side", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :photo_check_all_damages, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :photo_check_all_damages, "All Damages", :class => "inline" %>
        </div>
      </div>

      <div class="span4">
        <div class="check-line">
          <%= f.check_box :photo_check_rear, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :photo_check_rear, "Rear", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :photo_check_driver_side, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :photo_check_driver_side, "Driver Side", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :photo_check_windscreen, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :photo_check_windscreen, "Windscreen", :class => "inline" %>
        </div>
      </div>

      <div class="span4">
        <div class="check-line">
          <%= f.check_box :photo_check_fuel_gauge, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :photo_check_fuel_gauge, "Fuel Gauge", :class => "inline" %>
        </div>

        <div class="check-line">
          <%= f.check_box :photo_check_rego_label, {:class => "icheck-me", "data-skin" => "square", "data-color" => "green"} %>
          <%= f.label :photo_check_rego_label, "Rego Label", :class => "inline" %>
        </div>
      </div>
    </div>

  </div>

  <% if mode == 'create' %>
    <%= f.submit 'Create Report', class: "form-submit-btn" %>
  <% else %>
    <%= f.submit 'Update Report', class: "form-submit-btn" %>
  <% end %>
  
<% end %>

<div class="box-title">
  <h3><i class="glyphicon-paperclip"></i>Upload Photos &amp; Attachments</h3>
</div>
<% if @off_hire_report.id %>
  <div class="box-content" style="padding: 30px 50px;">
    <div id="file-uploads-container">
      <%= form_for OffHireReportUpload.new, :html => { :multipart => true, :id => "offhirereportupload", "data-off-hire-report-id" => @off_hire_report.id  } do |f| %>
        <!-- The fileupload-buttonbar contains buttons to add/delete files and start/cancel the upload -->
        <div class="row fileupload-buttonbar">
          <div class="span7">
            <!-- The fileinput-button span is used to style the file input field as button -->
            <span class="btn btn-success fileinput-button">
              <i class="icon-plus icon-white"></i>
              <span>Add files...</span>
              <%= f.file_field :upload %>
              <%= f.hidden_field :off_hire_report_id, :value => @off_hire_report.id, :id => "off_hire_report_id" %>
            </span>
            <button type="submit" class="btn btn-primary start">
              <i class="icon-upload icon-white"></i>
              <span>Start upload</span>
            </button>
            <button type="reset" class="btn btn-orange cancel">
              <i class="icon-ban-circle icon-white"></i>
              <span>Cancel upload</span>
            </button>
          </div>
          <div class="span5">
            <!-- The global progress bar -->
            <div class="progress progress-success progress-striped active fade">
              <div class="bar" style="width:0%;"></div>
            </div>
          </div>
        </div>
        <!-- The loading indicator is shown during image processing -->
        <div class="fileupload-loading"></div>
        <br>
        <!-- The table listing the files available for upload/download -->
        <table class="table table-striped"><tbody class="files" data-toggle="modal-gallery" data-target="#modal-gallery"></tbody>
        </table>
      <% end %>

      <%= render 'shared/form_upload' %>
      <%= render 'shared/form_download' %>
    </div>
  </div>
<% else %>
  <div class="box-content">
    <span class="alert alert-warning"><i class="icon-warning-sign" style="margin-right:3px"></i> Create report to enable file attachments. </span>
  </div>
<% end %>
